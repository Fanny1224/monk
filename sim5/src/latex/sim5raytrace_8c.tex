\hypertarget{sim5raytrace_8c}{}\section{sim5raytrace.\+c File Reference}
\label{sim5raytrace_8c}\index{sim5raytrace.\+c@{sim5raytrace.\+c}}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{sim5raytrace_8c_ab9c3327c657dee97ef91606a285a4b0a}\label{sim5raytrace_8c_ab9c3327c657dee97ef91606a285a4b0a}} 
\#define \hyperlink{sim5raytrace_8c_ab9c3327c657dee97ef91606a285a4b0a}{raytrace\+\_\+max\+\_\+error}~1e-\/2
\begin{DoxyCompactList}\small\item\em default maximal relative error of raytracing \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
D\+E\+V\+I\+C\+E\+F\+U\+NC void \hyperlink{sim5raytrace_8c_acc8eccb8205d4f2ddcb9999e4f757d28}{raytrace\+\_\+prepare} (double bh\+\_\+spin, double x\mbox{[}4\mbox{]}, double k\mbox{[}4\mbox{]}, double f\mbox{[}4\mbox{]}, double presision\+\_\+factor, int options, \hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$rtd)
\item 
D\+E\+V\+I\+C\+E\+F\+U\+NC void \hyperlink{sim5raytrace_8c_abed3b5c0234b26c6adb33a93e6150ccc}{raytrace} (double x\mbox{[}4\mbox{]}, double k\mbox{[}4\mbox{]}, double f\mbox{[}4\mbox{]}, double $\ast$step, \hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$rtd)
\item 
D\+E\+V\+I\+C\+E\+F\+U\+NC double \hyperlink{sim5raytrace_8c_a52e00132b407cc9cfddf66e6da980ca5}{raytrace\+\_\+error} (double x\mbox{[}4\mbox{]}, double k\mbox{[}4\mbox{]}, double f\mbox{[}4\mbox{]}, \hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$rtd)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Raytracing.

Provides routines for step-\/wise raytracing. 

\subsection{Function Documentation}
\mbox{\Hypertarget{sim5raytrace_8c_abed3b5c0234b26c6adb33a93e6150ccc}\label{sim5raytrace_8c_abed3b5c0234b26c6adb33a93e6150ccc}} 
\index{sim5raytrace.\+c@{sim5raytrace.\+c}!raytrace@{raytrace}}
\index{raytrace@{raytrace}!sim5raytrace.\+c@{sim5raytrace.\+c}}
\subsubsection{\texorpdfstring{raytrace()}{raytrace()}}
{\footnotesize\ttfamily D\+E\+V\+I\+C\+E\+F\+U\+NC void raytrace (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}4\mbox{]},  }\item[{double}]{k\mbox{[}4\mbox{]},  }\item[{double}]{f\mbox{[}4\mbox{]},  }\item[{double $\ast$}]{step,  }\item[{\hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$}]{rtd }\end{DoxyParamCaption})}

Raytracing with step-\/wise null-\/geodesic integration. Makes one step along the geodesic that is tangent to {\ttfamily k} and updates input vectors with new values. The integration method follows Dolence+2009 (\href{http://adsabs.harvard.edu/abs/2009ApJS..184..387D}{\tt http\+://adsabs.\+harvard.\+edu/abs/2009\+Ap\+J\+S..\+184..\+387D}).

The routine automatically controls size of the step based on curvature and required precission. On each call to \hyperlink{sim5raytrace_8c_abed3b5c0234b26c6adb33a93e6150ccc}{raytrace()} the routine takes a step size, which is smaller of the two\+: the internally chosen step size and step size that is passed on input in {\ttfamily step}.

Numerical precision is driven by the precision\+\_\+factor modifier \mbox{[}see \hyperlink{sim5raytrace_8c_acc8eccb8205d4f2ddcb9999e4f757d28}{raytrace\+\_\+prepare()}\mbox{]}; rtd-\/$>$error gives the error in the current step and it should be bellow raytrace\+\_\+max\+\_\+error$\ast$1e-\/2; so it is adviceable to check rtd-\/$>$error continuously after each step and stop integration when the error goes above $\sim$1e-\/3; at the end of integration one should then check relative difference in Carter\textquotesingle{}s constant with {\ttfamily \hyperlink{sim5raytrace_8c_a52e00132b407cc9cfddf66e6da980ca5}{raytrace\+\_\+error()}}.


\begin{DoxyParams}{Parameters}
{\em x} & position vector \\
\hline
{\em k} & direction vector (photon 4-\/momentum) \\
\hline
{\em f} & polarization vector (optional, can be N\+U\+LL) \\
\hline
{\em step} & on input gives maximal step that the routine can take \mbox{[}G\+M/c2\mbox{]}; on output gives size of step that has actually been taken \\
\hline
{\em rtd} & raytracing data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Position, direction and polarization (if not null) vectors and step size are updated, {\ttfamily rtd} has the relative error. 
\end{DoxyReturn}
\mbox{\Hypertarget{sim5raytrace_8c_a52e00132b407cc9cfddf66e6da980ca5}\label{sim5raytrace_8c_a52e00132b407cc9cfddf66e6da980ca5}} 
\index{sim5raytrace.\+c@{sim5raytrace.\+c}!raytrace\+\_\+error@{raytrace\+\_\+error}}
\index{raytrace\+\_\+error@{raytrace\+\_\+error}!sim5raytrace.\+c@{sim5raytrace.\+c}}
\subsubsection{\texorpdfstring{raytrace\+\_\+error()}{raytrace\_error()}}
{\footnotesize\ttfamily D\+E\+V\+I\+C\+E\+F\+U\+NC double raytrace\+\_\+error (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}4\mbox{]},  }\item[{double}]{k\mbox{[}4\mbox{]},  }\item[{double}]{f\mbox{[}4\mbox{]},  }\item[{\hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$}]{rtd }\end{DoxyParamCaption})}

Raytracing error. Gives relative error in raytracing in terms of relative difference of Carter\textquotesingle{}s constant. Useful for checking precission of integration.


\begin{DoxyParams}{Parameters}
{\em x} & position vector \\
\hline
{\em k} & direction vector \\
\hline
{\em f} & polarization vector (optional, can be N\+U\+LL) \\
\hline
{\em rtd} & raytracing data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Relative error in raytracing. 
\end{DoxyReturn}
\mbox{\Hypertarget{sim5raytrace_8c_acc8eccb8205d4f2ddcb9999e4f757d28}\label{sim5raytrace_8c_acc8eccb8205d4f2ddcb9999e4f757d28}} 
\index{sim5raytrace.\+c@{sim5raytrace.\+c}!raytrace\+\_\+prepare@{raytrace\+\_\+prepare}}
\index{raytrace\+\_\+prepare@{raytrace\+\_\+prepare}!sim5raytrace.\+c@{sim5raytrace.\+c}}
\subsubsection{\texorpdfstring{raytrace\+\_\+prepare()}{raytrace\_prepare()}}
{\footnotesize\ttfamily D\+E\+V\+I\+C\+E\+F\+U\+NC void raytrace\+\_\+prepare (\begin{DoxyParamCaption}\item[{double}]{bh\+\_\+spin,  }\item[{double}]{x\mbox{[}4\mbox{]},  }\item[{double}]{k\mbox{[}4\mbox{]},  }\item[{double}]{f\mbox{[}4\mbox{]},  }\item[{double}]{presision\+\_\+factor,  }\item[{int}]{options,  }\item[{\hyperlink{structraytrace__data}{raytrace\+\_\+data} $\ast$}]{rtd }\end{DoxyParamCaption})}

Raytracing with step-\/wise null-\/geodesic integration. Makes one step along the geodesic that is tangent to {\ttfamily k} and updates input vectors with new values. The integration method follows Dolence+2009 (\href{http://adsabs.harvard.edu/abs/2009ApJS..184..387D}{\tt http\+://adsabs.\+harvard.\+edu/abs/2009\+Ap\+J\+S..\+184..\+387D}).

The routine automatically controls size of the step based on curvature and required precission. On each call to \hyperlink{sim5raytrace_8c_abed3b5c0234b26c6adb33a93e6150ccc}{raytrace()} the routine takes a step size, which is smaller of the two\+: the internally chosen step size and step size that is passed on input in {\ttfamily step}.

Numerical precision of integration is driven by the precision\+\_\+factor modifier and raytrace\+\_\+max\+\_\+error constant; roughly, final error (after whole geodesic is integrated) is\+: maximal relative error = (a factor of few) $\ast$ raytrace\+\_\+max\+\_\+error $\ast$ precision\+\_\+factor.


\begin{DoxyParams}{Parameters}
{\em bh\+\_\+spin} & black hole spin \\
\hline
{\em x} & initial position vector \\
\hline
{\em k} & initial direction vector (photon 4-\/momentum) \\
\hline
{\em f} & initial polarization vector (optional, can be N\+U\+LL) \\
\hline
{\em precision\+\_\+factor} & precision factor \\
\hline
{\em options} & additional options \\
\hline
{\em rtd} & raytracing data \\
\hline
\end{DoxyParams}
